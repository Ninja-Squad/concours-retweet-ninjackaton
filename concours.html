<!DOCTYPE html>
<html>
<head>
    <title>Le concours de retweets du Ninjackaton</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/css/bootstrap-combined.min.css" rel="stylesheet">
</head>
<body>

<div class="container">
	<br/>
	<div class="hero-unit">
		<div class="row-fluid">
			<div class="span2">
				<img src="chuck.png" alt="Chuck : le logo Ninja Squad" />
			</div>
			<div class="span9 offset1">
				<a href="http://ninja-squad.com">Ninja Squad</a> organisait un concours de retweet de leur article consacr√© au Ninjackaton.<br/>
				Vous pouviez alors gagner un merveilleux tee-shirt arborant Chuck, notre logo.
			</div>
		</div>
		
	</div>
	
	<h2>Les participants au concours</h1>
	<table id="contestants" class="table table-striped table-bordered">
		<thead>
			<tr>
				<th>Username Twitter</th>
			</tr>
		</thead>
		<tbody>
		</tbody>
	</table>

	<h2>Comment?</h2>
	<p>
		Aucune triche dans l'obtention de cette liste : le <a href="https://github.com/Ninja-Squad/concours-retweet-ninjackaton" title="Code source de cette page sur le GitHub de Ninja Squad">code source est disponible</a>.
	</p>
</div>

<script src="http://code.jquery.com/jquery.js"></script>
<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/js/bootstrap.min.js"></script>
<script>
var urlRetweets = [
	"https://api.twitter.com/1/statuses/301679956147187713/retweeted_by.json?count=100&callback=?", 
	"https://api.twitter.com/1/statuses/301678974201905154/retweeted_by.json?count=100&callback=?"];

var urlSearchBlog = [
	"http://search.twitter.com/search.json?q=http%3A%2F%2Fblog.ninja-squad.com%2F2013%2F02%2F13%2Fjava-8&rpp=100&result_type=recent&callback=?"
]


$(function() {
	$(urlRetweets).each(function(index, item) {
		$.getJSON(item, function(users) {
			$(users).each(function(index,user) {
				addContestant(user.screen_name);
			});
		});
	});

	$(urlSearchBlog).each(function(index, item) {
		$.getJSON(item, function(results) {
			$(results.results).each(function(index,tweet) {
				addContestant(tweet.from_user);
			});
		});
	});

	var contestants = [];
	function addContestant(username) {
		if (!isNinja(username)) {
			if ($.inArray(username,contestants) < 0) {
				contestants.push(username);
				$("#contestants tbody").append("<tr><td><a href='http://twitter.com/"+username+"'>@"+username+"</a></td></tr>")
			}
		}
	}

	var ninjas=["agnes_crepet", "cedric_exbrayat", "jbnizet", "clacote", "ninjasquad"];
	function isNinja(username) {
		return ($.inArray(username.toLowerCase(), ninjas) >= 0);
	}
})



</script>
</body>
</html>
